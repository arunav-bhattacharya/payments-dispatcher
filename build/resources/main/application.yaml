# =============================================================================
# Payment Dispatch System â€” Application Configuration
# =============================================================================

# --- Dispatch Settings -------------------------------------------------------
dispatch:
  default-item-type: PAYMENT
  schedule-id: dispatch-payment-schedule
  auto-create-schedule: true
  dispatch-interval-secs: 5

  # --- Temporal Connection ---------------------------------------------------
  temporal:
    target: "${TEMPORAL_TARGET:localhost:7233}"
    namespace: "${TEMPORAL_NAMESPACE:default}"

  # --- Task Queues -----------------------------------------------------------
  task-queues:
    dispatcher: dispatch-task-queue
    payment-init: payment-init-task-queue
    payment-exec: payment-exec-task-queue

  # --- Worker Concurrency ----------------------------------------------------
  workers:
    dispatch:
      max-concurrent-workflows: 5
      max-concurrent-activities: 10
    payment-init:
      max-concurrent-workflows: 100
      max-concurrent-activities: 200
    payment-exec:
      max-concurrent-workflows: 100
      max-concurrent-activities: 200

# --- Quarkus Configuration ---------------------------------------------------
quarkus:
  # --- Oracle Datasource (Agroal connection pool) ----------------------------
  datasource:
    db-kind: oracle
    username: "${ORACLE_USER:dispatch_user}"
    password: "${ORACLE_PASSWORD:dispatch_pass}"
    jdbc:
      url: "${ORACLE_JDBC_URL:jdbc:oracle:thin:@//localhost:1521/XEPDB1}"
      max-size: 20
      min-size: 5
      initial-size: 5
      acquisition-timeout: 10S

  # --- Jackson ---------------------------------------------------------------
  jackson:
    serialization-inclusion: non-null

  # --- Micrometer / Prometheus -----------------------------------------------
  micrometer:
    export:
      prometheus:
        enabled: true
        path: /q/metrics

  # --- Health Checks ---------------------------------------------------------
  health:
    extensions:
      enabled: true

  # --- Logging ---------------------------------------------------------------
  log:
    level: INFO
    category:
      "com.payment.dispatcher":
        level: DEBUG
      "org.jetbrains.exposed":
        level: INFO
      "io.temporal":
        level: INFO
